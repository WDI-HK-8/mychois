app.controller('BuyerShowCtrl', ['$scope', '$http', '$auth', '$location','$routeParams', function($scope, $http, $auth, $location, $routeParams){
  console.log("hello");
  var url = "<%= ENV['URL'] %>" || "http://localhost:3000"
  $scope.grocery_list_items_display = []

  $http.get(url + '/api/v1/grocery_lists/' + $routeParams.id).
  then(function(response){
    $scope.grocery_list = response.data;
    if ($scope.grocery_list.substitutions == null){
      $scope.grocery_list.substitutions = false;
    }
    console.log(response);
      $scope.grocery_list = response.data;  
      $scope.grocery_list.grocery_list_items.forEach(function(element,index){
        console.log(element.quantity)
        $http.get(url + '/api/v1/grocery_lists/' + $routeParams.id + '/grocery_list_items/' + element.id).then(function(response){
          $scope.grocery_list_items_display[index] = {name: response.data.grocery.name, quantity: element.quantity, current_price: element.current_price, total_price: element.total_price};
          console.log($scope.grocery_list_items_display)
        })
      })
  }).
  catch(function(response){
    console.log("not found", response);
  });

  $scope.takeOrder = function() {
    $http.put(url + '/api/v1/grocery_lists/' + $routeParams.id + '/add_worker').then(function(response){
      alert(response.data.message);
    });
  }
}]);

